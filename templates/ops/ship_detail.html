@@ -15,45 +15,45 @@
  </div>

  {% if can_edit %}
  <div class="rounded-2xl border border-white/10 bg-white/[0.03] p-4">
    <h2 class="font-medium mb-3">Add role template</h2>
    <form method="post" class="grid sm:grid-cols-3 gap-3">
      {% csrf_token %}
      {{ role_form.role_name }}
      {{ role_form.slots }}
      <button class="rounded border border-white/15 bg-white/[0.04] hover:bg-white/[0.08] px-3 py-2">Add</button>
    </form>
    <p class="text-xs text-white/50 mt-2">Missing slots are created automatically.</p>
  </div>
  {% endif %}

  {% for role, slots in slots_by_role.items %}
  <div class="rounded-2xl border border-white/10 bg-white/[0.03] p-4">
    <div class="font-medium mb-3">{{ role }}</div>
    <div class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
      {% for s in slots %}
      <form method="post" action="{% url 'role_slot_update' s.pk %}" class="rounded-xl bg-white/5 border border-white/10 p-3">
        {% csrf_token %}
        <div class="text-xs text-white/60 mb-2">Slot #{{ s.index }}</div>
        <select name="user" class="w-full bg-black/40 border border-white/15 rounded px-2 py-1 mb-2">
          <option value="">— free —</option>
          {% for u in request.user.__class__.objects.all %}
          <option value="{{ u.id }}" {% if s.user_id == u.id %}selected{% endif %}>{{ u.username }}</option>
          {% for u in all_users %}
          <option value="{{ u.pk }}" {% if s.user_id == u.pk %}selected{% endif %}>{{ u.get_username }}</option>
          {% endfor %}
        </select>
        <select name="status" class="w-full bg-black/40 border border-white/15 rounded px-2 py-1 mb-3">
          <option value="open" {% if s.status == 'open' %}selected{% endif %}>Free</option>
          <option value="assigned" {% if s.status == 'assigned' %}selected{% endif %}>Assigned</option>
          <option value="confirmed" {% if s.status == 'confirmed' %}selected{% endif %}>Confirmed</option>
        </select>
        <button class="w-full rounded border border-white/15 bg-white/[0.04] hover:bg-white/[0.08] px-3 py-1.5">Save</button>
      </form>
      {% endfor %}
    </div>
  </div>
  {% empty %}
  <p class="text-white/60">No roles defined for this ship.</p>
  {% endfor %}

</section>
{% endblock %}